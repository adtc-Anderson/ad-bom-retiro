<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">

  <title>ADTC Bom Retiro | Assembleia de Deus</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- =====================
       SEO BÃSICO
       ===================== -->
  <meta name="description"
        content="ADTC Bom Retiro â€“ Assembleia de Deus | IEADTC Industrial. Cultos, agenda mensal, dÃ­zimos e localizaÃ§Ã£o.">

  <!-- =====================
       FONTE
       ===================== -->
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap"
        rel="stylesheet">

  <!-- =====================
       ÃCONES / APP
       ===================== -->
  <!-- Favicon -->
  <link rel="icon" href="img/icon-192.png">

  <!-- Android / PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0b3c5d">

  <!-- iOS -->
  <link rel="apple-touch-icon" href="img/icon-192.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-title" content="ADTC Bom Retiro">

  <!-- =====================
       PREVIEW DE COMPARTILHAMENTO
       ===================== -->
  <meta property="og:title" content="ADTC Bom Retiro â€“ Assembleia de Deus">
  <meta property="og:description"
        content="IEADTC Industrial | Cultos, agenda mensal, dÃ­zimos e localizaÃ§Ã£o.">
  <meta property="og:image"
        content="https://adtc-anderson.github.io/ad-bom-retiro/img/icon-512.png">
  <meta property="og:url"
        content="https://adtc-anderson.github.io/ad-bom-retiro/">
  <meta property="og:type" content="website">

  <!-- =====================
       CSS
       ===================== -->
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">


  <!-- =====================
       QR CODE
       ===================== -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js" defer></script>

</head>


<body>

<!-- HEADER -->
<header>
  <div class="logo-wrapper">
    <img src="img/logoA.png"
     alt="ADTC Bom Retiro"
     loading="eager"
     width="200">
  </div>

  <h1>ADTC Bom Retiro</h1>
  <p>IEADTC - INDUSTRIAL</p>
</header>

<!-- MENU -->
<nav class="nav">
  <button class="nav-toggle" onclick="toggleMenu()">â˜°</button>

  <div class="nav-links" id="navLinks">
    <a href="#sobre" onclick="fecharMenu()">Sobre</a>
    <a href="#cultos" onclick="fecharMenu()">Cultos</a>
    <a href="#agenda-mensal-card" onclick="fecharMenu()">Agenda</a>
    <a href="#pix" onclick="fecharMenu()">DÃ­zimos & Ofertas</a>
    <a href="#local" onclick="fecharMenu()">LocalizaÃ§Ã£o</a>
  </div>
</nav>

<div class="container">

  <div class="card versiculo-card" id="versiculo-card">
    <h2>âœ¨ VersÃ­culo do Dia</h2>

    <p class="versiculo-texto">
      Carregando a Palavra...
    </p>

    <p class="versiculo-ref"></p>

    <div class="versiculo-acoes">
      <button onclick="atualizarVersiculo()">
        <i class="bi bi-arrow-repeat"></i>
        Atualizar
      </button>

      <button onclick="curtirVersiculo()">
        <i class="bi bi-heart-fill"></i>
        Curtir
      </button>

      <button onclick="compartilharVersiculo()">
        <i class="bi bi-share"></i>
        Compartilhar
      </button>
    </div>

  </div>

  <div class="card" id="sobre" style="text-align:center;">
    <h2>ğŸ“– Sobre a Igreja</h2>

    <p>
    A ADTC Bom Retiro Ã© uma congregaÃ§Ã£o cristÃ£ vinculada Ã  IEADTC Industrial,
    comprometida com a pregaÃ§Ã£o fiel do Evangelho de Jesus Cristo, a comunhÃ£o
    dos irmÃ£os e o serviÃ§o ao prÃ³ximo, fundamentada na Palavra de Deus.
    </p>

    <p>
    Estamos sob a lideranÃ§a pastoral da sede, presidida pelo
    <strong>Pr. JoÃ£o LourenÃ§o da Silva</strong>, e contamos com a lideranÃ§a
    local do <strong>Presb. Gilvan F. de Medeiros</strong>, sempre seguindo a
    doutrina e a DeclaraÃ§Ã£o de FÃ© das Assembleias de Deus no Brasil.
    </p>

  </div>

  <div class="card" id="cultos">

    <div style="text-align:center;">
     <h2>â° HorÃ¡rios de Culto</h2>
    </div>
    
    <ul class="lista-cultos">

      <li>
        <span class="icon">ğŸ”¥</span>
        <div class="culto-info">
          <strong class="culto-dia">TerÃ§a-feira</strong>
          <span class="culto-tipo">CÃ­rculo de OraÃ§Ã£o</span>
          <small class="culto-hora">19:00 Ã s 21:00</small>
        </div>
      </li>

      <li>
        <span class="icon">ğŸ“˜</span>
        <div class="culto-info">
          <strong class="culto-dia">Quinta-feira</strong>
          <span class="culto-tipo">Doutrina</span>
          <small class="culto-hora">19:00 Ã s 21:00</small>
        </div>
      </li>

      <li>
        <span class="icon">ğŸ“–</span>
        <div class="culto-info">
          <strong class="culto-dia">Domingo</strong>
          <span class="culto-tipo">EBD â€“ Escola BÃ­blica Dominical</span>
          <small class="culto-hora">09:00 Ã s 11:00</small>
        </div>
      </li>

      <li>
        <span class="icon">ğŸ™</span>
        <div class="culto-info">
          <strong class="culto-dia">Domingo</strong>
          <span class="culto-tipo">Culto</span>
          <small class="culto-hora">18:00 Ã s 20:00</small>
        </div>
      </li>

      </ul>


  </div>

    <!-- =========================
        AGENDA MENSAL
        ========================= -->
    <div class="card" id="agenda-mensal-card">
    <h2 style="text-align:center;">ğŸ“… Agenda Mensal</h2>

    <div class="agenda-header">
        <button onclick="mesAnterior()">â—€</button>
        <strong id="mesAno"></strong>
        <button onclick="mesSeguinte()">â–¶</button>
    </div>

    <div class="agenda-semana">
    <div class="fds">Dom</div>
    <div>Seg</div>
    <div>Ter</div>
    <div>Qua</div>
    <div>Qui</div>
    <div>Sex</div>
    <div class="fds">SÃ¡b</div>
    </div>

    <div class="agenda-grid" id="agendaGrid"></div>

    <div class="agenda-legenda-wrapper">

      <button class="btn-legenda-toggle" onclick="toggleLegenda()">
        â„¹ï¸ Mostrar legenda
      </button>

      <div class="agenda-legenda" id="agendaLegenda">
        <span data-tipo="oracao">ğŸ”¥ CÃ­rculo de OraÃ§Ã£o</span>
        <span data-tipo="culto">ğŸ™ Culto</span>
        <span data-tipo="doutrina">ğŸ“˜ Doutrina</span>
        <span data-tipo="ebd">ğŸ“– EBD</span>
        <span data-tipo="familia">ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ FamÃ­lia</span>
        <span data-tipo="gratidao">ğŸ™Œ GratidÃ£o</span>
        <span data-tipo="humilhacao">ğŸ•Šï¸ HumilhaÃ§Ã£o</span>
        <span data-tipo="missoes">ğŸŒ MissÃµes</span>
        <span data-tipo="primicias">ğŸŒ¾ PrimÃ­cias</span>
        <span data-tipo="consagracao">â˜€ï¸ ConsagraÃ§Ã£o</span>
        <span data-tipo="especial">âœï¸ Santa Ceia</span>
        <span data-tipo="vigilia">ğŸŒ™ VigÃ­lia</span>
        <span data-tipo="senhoras">ğŸŒ¸ Senhoras</span>
        <span data-tipo="jovens">ğŸ¸ Jovens</span>
        <span data-tipo="criancas">ğŸ§¸ CrianÃ§as</span>
        <span data-tipo="sede">ğŸ›¡ï¸ Sede</span>
      </div>

    </div>

    <p style="text-align:center;font-size:13px;color:#555;margin-top:10px;">
        ğŸ”µ Clique nos dias destacados para ver detalhes
    </p>
    </div>

    <!-- =========================
        AGENDA SEMANAL
        ========================= -->
    <div class="card" id="agenda-semanal-card">
    <h2 style="text-align:center;">ğŸ“† Agenda da Semana</h2>

    <div class="agenda-semanal" id="agendaSemanal"></div>

    <p style="text-align:center;font-size:13px;color:#555;">
        ğŸ‘‰ Arraste para o lado para ver os prÃ³ximos dias
    </p>
    </div>

  <div class="card" id="pix">

    <div style="text-align:center;">


      <h2>ğŸ’³ DÃ­zimos & Ofertas (PIX)</h2>

      <p><strong>Chave PIX:</strong> 85986498687</p>
      <p><strong>Recebedor:</strong> Giselle Farias Medeiros</p>

      <label><strong>Valor (R$)</strong></label><br><br>

      <input
        type="text"
        id="valorPix"
        placeholder="Ex: 50,00"
        inputmode="numeric"
        pattern="[0-9]*"
        maxlength="10"
        oninput="formatarValor(this)"
      >

      <p id="valorResumo"
        style="margin-top:12px;font-weight:700;font-size:18px;text-align:center;color:#0b3c5d;">
      </p>

    
      <button id="btnPix" onclick="gerarPix()" disabled>
        Gerar QR Code PIX
      </button>

    </div>

    <div style="display:flex; justify-content:center; margin-top:25px;">
      <canvas id="qrcode"></canvas>
    </div>

    <div style="text-align:center; margin-top:10px;">
      <button id="btnCopiarPix" onclick="copiarPix()" disabled>
        ğŸ“‹ Copiar cÃ³digo PIX
      </button>
    </div>

    <p id="msgCopiado"
      style="text-align:center;margin-top:8px;color:green;font-weight:600;display:none;">
      âœ… CÃ³digo PIX copiado!
    </p>

    <p style="font-size:13px; text-align:center; color:#555;">
      ğŸ”’ Confira no app do banco se o recebedor Ã©
      <strong>Giselle Farias Medeiros</strong>.
    </p>

    <p style="font-style:italic; text-align:center;">
      â€œCada um contribua segundo propÃ´s no coraÃ§Ã£o.â€ â€“ 2Co 9:7
    </p>
  </div>

    <div class="card" id="local" style="text-align:center;">
    <h2>ğŸ“ LocalizaÃ§Ã£o</h2>

    <div class="mapa">
    <iframe
        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d3980.7212173127655!2d-38.55710292415437!3d-3.8698593439099076!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x7c7517232d23c47%3A0x6c973756dbaefd97!2sADTC%20Bom%20Retiro!5e0!3m2!1spt-PT!2sbr!4v1769972745947!5m2!1spt-PT!2sbr" width="600" height="450" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"
        loading="lazy"
        referrerpolicy="no-referrer-when-downgrade"
        allowfullscreen>
    </iframe>
    </div>


    <a href="https://adindustrial.com.br"
    target="_blank"
    rel="noopener noreferrer"
    class="logo-industrial"
    title="Visitar site da AD Industrial">

    <img src="https://adindustrial.com.br/wp-content/uploads/2024/12/logo-cor.png.webp"
        loading="lazy"
        alt="AD Industrial">
    </a>

    </div>


</div>

<a class="whatsapp"
   href="https://wa.me/5585986498687"
   target="_blank"
   title="Fale conosco no WhatsApp"
   aria-label="WhatsApp">
  <svg xmlns="http://www.w3.org/2000/svg"
       viewBox="0 0 32 32"
       width="26" height="26"
       fill="white">
    <path d="M19.11 17.53c-.27-.14-1.58-.78-1.83-.87-.25-.09-.43-.14-.61.14-.18.27-.7.87-.86 1.05-.16.18-.32.2-.59.07-.27-.14-1.14-.42-2.17-1.34-.8-.71-1.34-1.58-1.5-1.85-.16-.27-.02-.42.12-.56.12-.12.27-.32.41-.48.14-.16.18-.27.27-.45.09-.18.05-.34-.02-.48-.07-.14-.61-1.47-.84-2.01-.22-.54-.45-.47-.61-.48-.16-.01-.34-.01-.52-.01-.18 0-.48.07-.73.34-.25.27-.96.94-.96 2.29 0 1.35.99 2.66 1.13 2.84.14.18 1.95 2.98 4.73 4.18.66.28 1.18.45 1.58.58.66.21 1.26.18 1.73.11.53-.08 1.58-.65 1.8-1.28.22-.63.22-1.17.16-1.28-.07-.11-.25-.18-.52-.32z"/>
    <path d="M16 2.67C8.83 2.67 3 8.5 3 15.67c0 2.76.73 5.35 2.12 7.61L3 29l5.87-2.04c2.19 1.19 4.7 1.82 7.13 1.82 7.17 0 13-5.83 13-13S23.17 2.67 16 2.67zm0 23.13c-2.27 0-4.5-.61-6.44-1.76l-.46-.27-3.48 1.21 1.13-3.38-.3-.48c-1.3-2.04-1.99-4.4-1.99-6.79 0-6.98 5.68-12.67 12.67-12.67S28.67 8.35 28.67 15.33 22.98 28 16 28z"/>
  </svg>
</a>


<!-- MODAL -->
<div class="modal" id="modalEvento" onclick="clicouForaModal(event)">

  <div class="modal-conteudo" role="dialog" aria-modal="true">

    <h3 id="modalTitulo"></h3>
    <p id="modalData"></p>

    <div id="modalListaEventos"></div>

    <button onclick="fecharModal()">Fechar</button>

  </div>

</div>

<footer>
  ADTC Bom Retiro â€“ Assembleia de Deus<br>
  Desenvolvido por Anderson Maia<br>
  <small>Â© 2026 â€“ VersÃ£o 1.0.5</small>
</footer>

<script>

  let VERSICULOS_BASE = [];
  let indiceVersiculo = 0;

  /* ğŸ”¹ carrega versiculos.json */
  async function carregarVersiculos() {
    try {
      const resp = await fetch("versiculos.json?v=" + Date.now());
      const data = await resp.json();

      VERSICULOS_BASE = data.versiculos || [];

      // Ã­ndice salvo (nÃ£o repete atÃ© acabar)
      indiceVersiculo = parseInt(
        localStorage.getItem("idxVersiculo") || "0"
      );

      carregarVersiculo(); // carrega o primeiro

    } catch (e) {
      console.error("Erro ao carregar versÃ­culos:", e);
    }
  }

  function versiculoDoDia() {
    if (VERSICULOS_BASE.length === 0) return null;

    const hoje = new Date();
    return VERSICULOS_BASE[
      hoje.getDate() % VERSICULOS_BASE.length
    ];
  }

  let versiculoAtual = "";
  let referenciaAtual = "";

  async function carregarVersiculo(forcarNovo = false) {
  const ref = forcarNovo
    ? VERSICULOS_BASE[Math.floor(Math.random() * VERSICULOS_BASE.length)]
    : versiculoDoDia();

  const url = `https://bible-api.com/${encodeURIComponent(ref)}?translation=almeida`;

  try {
    const resp = await fetch(url);
    const data = await resp.json();

    versiculoAtual = data.text.trim();
    referenciaAtual = data.reference;

    document.querySelector(".versiculo-texto").innerText = versiculoAtual;
    document.querySelector(".versiculo-ref").innerText = referenciaAtual;

  } catch {
    document.querySelector(".versiculo-texto").innerText =
      "A Palavra do Senhor permanece para sempre.";
    document.querySelector(".versiculo-ref").innerText =
      "1 Pedro 1:25";
  }
  }

  function atualizarVersiculo() {
    if (VERSICULOS_BASE.length === 0) return;

    const ref =
      VERSICULOS_BASE[indiceVersiculo % VERSICULOS_BASE.length];

    indiceVersiculo++;
    localStorage.setItem("idxVersiculo", indiceVersiculo);

    carregarVersiculoPorReferencia(ref);
  }

  async function carregarVersiculoPorReferencia(ref) {
    const url = `https://bible-api.com/${encodeURIComponent(ref)}?translation=almeida`;

    try {
      const resp = await fetch(url);
      const data = await resp.json();

      versiculoAtual = data.text.trim();
      referenciaAtual = data.reference;

      document.querySelector(".versiculo-texto").innerText = versiculoAtual;
      document.querySelector(".versiculo-ref").innerText = referenciaAtual;

    } catch {
      document.querySelector(".versiculo-texto").innerText =
        "A Palavra do Senhor permanece para sempre.";
      document.querySelector(".versiculo-ref").innerText =
        "1 Pedro 1:25";
    }
  }

  function curtirVersiculo() {
  if (!versiculoAtual) return;

  const curtidos = JSON.parse(localStorage.getItem("versiculosCurtidos") || "[]");

  curtidos.push({
    texto: versiculoAtual,
    referencia: referenciaAtual,
    data: new Date().toISOString()
  });

  localStorage.setItem("versiculosCurtidos", JSON.stringify(curtidos));

  // ğŸ”¥ feedback visual
  document.querySelector(".versiculo-acoes button:nth-child(2)")
    .classList.add("curtido");

  alert("â¤ï¸ VersÃ­culo salvo!");
  }

  function compartilharVersiculo() {
  if (!versiculoAtual) return;

  const texto = `ğŸ“– *VersÃ­culo do Dia*\n\n"${versiculoAtual}"\n\nğŸ“Œ ${referenciaAtual}`;
  const url = `https://wa.me/?text=${encodeURIComponent(texto)}`;

  window.open(url, "_blank");
  }


  let payloadPixGerado = '';
  
  
  function toggleLegenda() {
    const legenda = document.getElementById("agendaLegenda");
    const btn = document.querySelector(".btn-legenda-toggle");

    legenda.classList.toggle("show");

    if (legenda.classList.contains("show")) {
      btn.innerText = "â„¹ï¸ Ocultar legenda";
    } else {
      btn.innerText = "â„¹ï¸ Mostrar legenda";
    }
  }

  
  function formatarValor(campo) {
    let v = campo.value.replace(/\D/g, '');
    v = (v / 100).toFixed(2).replace('.', ',');
    campo.value = v;

    const valorNum = parseFloat(v.replace(',', '.'));
    const btnGerar = document.getElementById('btnPix');

    if (valorNum >= 1) {
      btnGerar.disabled = false;
      document.getElementById('valorResumo').innerText =
        'Valor informado: R$ ' + v;
    } else {
      btnGerar.disabled = true;
      document.getElementById('valorResumo').innerText = '';

      // ğŸ”¥ valor invÃ¡lido â†’ limpa tudo
      limparPix();
    }
  }


  function toggleMenu() {
    document.getElementById('navLinks').classList.toggle('show');
  }

  function fecharMenu() {
    document.getElementById('navLinks').classList.remove('show');
  }

  function crc16(payload) {
    let crc = 0xFFFF;
    for (let i = 0; i < payload.length; i++) {
      crc ^= payload.charCodeAt(i) << 8;
      for (let j = 0; j < 8; j++) {
        crc = (crc & 0x8000) ? (crc << 1) ^ 0x1021 : (crc << 1);
        crc &= 0xFFFF;
      }
    }
    return crc.toString(16).toUpperCase().padStart(4, '0');
  }

  function gerarPix() {

    // ğŸ”’ Sempre limpa antes de gerar (evita QR antigo)
    limparPix();

    const valor = parseFloat(
      document.getElementById('valorPix').value.replace(',', '.')
    );

    // proteÃ§Ã£o contra valor invÃ¡lido
    if (!valor || valor < 1) {
      return;
    }

    const valorFormatado = valor.toFixed(2);

    const chavePix = "+5585986498687";
    const nome = "GISELLE FARIAS MEDEIROS";
    const cidade = "PACATUBA";

    let payload =
      "000201" +
      "2636" +
        "0014BR.GOV.BCB.PIX" +
        "01" + chavePix.length.toString().padStart(2,'0') + chavePix +
      "52040000" +
      "5303986" +
      "54" + valorFormatado.length.toString().padStart(2,'0') + valorFormatado +
      "5802BR" +
      "59" + nome.length.toString().padStart(2,'0') + nome +
      "60" + cidade.length.toString().padStart(2,'0') + cidade +
      "6304";

    // calcula CRC
    payload += crc16(payload);

    // ğŸ”¥ salva o PIX vÃ¡lido
    payloadPixGerado = payload;

    // habilita copiar SOMENTE aqui
    document.getElementById('btnCopiarPix').disabled = false;

    // gera QR Code
    QRCode.toCanvas(
      document.getElementById('qrcode'),
      payload,
      { width: 240 }
    );
  }

  function limparPix() {
    payloadPixGerado = '';

    // limpa canvas do QR
    const canvas = document.getElementById('qrcode');
    if (canvas) {
      const ctx = canvas.getContext('2d');
      ctx.clearRect(0, 0, canvas.width, canvas.height);
    }

    // desabilita copiar
    document.getElementById('btnCopiarPix').disabled = true;
  }

  function copiarPix() {

    // ğŸ”’ proteÃ§Ã£o: PIX ainda nÃ£o gerado
    if (!payloadPixGerado || payloadPixGerado.length < 20) {
      alert('âš ï¸ Gere o QR Code com um valor vÃ¡lido antes de copiar.');
      return;
    }

    // ğŸ”’ proteÃ§Ã£o extra: valida valor novamente
    const valorCampo = document.getElementById('valorPix').value;
    const valorNum = parseFloat(valorCampo.replace(',', '.'));

    if (!valorNum || valorNum < 1) {
      alert('âš ï¸ Valor invÃ¡lido para copiar o PIX.');
      return;
    }

    navigator.clipboard.writeText(payloadPixGerado).then(() => {
      const msg = document.getElementById('msgCopiado');
      msg.style.display = 'block';

      setTimeout(() => {
        msg.style.display = 'none';
      }, 2500);
    });
  }

    /* =========================
    AGENDA DE CULTOS
    ========================= */

    function iconeTipo(tipo) {
      switch (tipo) {
        case "primicias": return "ğŸŒ¾";        // 1Âº domingo
        case "missoes":   return "ğŸŒ";        // 2Âº domingo
        case "familia":   return "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦";        // 3Âº domingo
        case "gratidao":  return "ğŸ™Œ";        // 4Âº domingo
        case "ebd":       return "ğŸ“–";        // ensino
        case "culto":     return "ğŸ™";        // culto geral
        case "oracao":    return "ğŸ”¥";        // terÃ§a â€“ cÃ­rculo de oraÃ§Ã£o
        case "doutrina":  return "ğŸ“˜";        // quinta â€“ doutrina
        case "vigilia":   return "ğŸŒ™";        // vigÃ­lia
        case "especial":  return "âœï¸";        // santa ceia / eventos especiais
        case "senhoras":  return "ğŸŒ¸";        // Culto de Senhoras
        case "jovens":    return "ğŸ¸";        // Culto dos Jovens
        case "criancas":  return "ğŸ§¸";        // Culto das CrianÃ§as
        case "humilhacao": return "ğŸ•Šï¸";       // Dia da HumilhaÃ§Ã£o (4Âº sÃ¡bado)
        case "consagracao": return "â˜€ï¸";      // Culto de ConsagraÃ§Ã£o
        case "sede": return "ğŸ›¡ï¸";             // Sede / Igreja Matriz

        default:          return "ğŸ“…";        // culto comum
      }
    }

    function eventosDoDia(dataStr) {
      const ev = cultos[dataStr];
      if (!ev) return [];
      return Array.isArray(ev) ? ev : [ev];
    }

    let dataAtual = new Date();

    function renderAgenda() {
    const grid = document.getElementById('agendaGrid');
    const titulo = document.getElementById('mesAno');

    grid.innerHTML = '';

    const ano = dataAtual.getFullYear();
    const mes = dataAtual.getMonth();

    const nomeMes = dataAtual.toLocaleString('pt-BR', { month: 'long' });
    titulo.innerText =
      nomeMes.charAt(0).toUpperCase() + nomeMes.slice(1) + ' ' + ano;

    const ultimoDia = new Date(ano, mes + 1, 0).getDate();

    const hoje = new Date();
    const hojeStr = `${hoje.getFullYear()}-${String(hoje.getMonth()+1).padStart(2,'0')}-${String(hoje.getDate()).padStart(2,'0')}`;

    const primeiroDiaSemana = new Date(ano, mes, 1).getDay();

    // espaÃ§os vazios
    for (let i = 0; i < primeiroDiaSemana; i++) {
      const vazio = document.createElement('div');
      vazio.className = 'agenda-dia';
      vazio.style.visibility = 'hidden';
      grid.appendChild(vazio);
    }

    for (let dia = 1; dia <= ultimoDia; dia++) {

      const dataStr = `${ano}-${String(mes+1).padStart(2,'0')}-${String(dia).padStart(2,'0')}`;
      const div = document.createElement('div');
      div.className = 'agenda-dia';

      const diaSemana = new Date(ano, mes, dia).getDay();
      const eventos = eventosDoDia(dataStr);
      const qtd = eventos.length;

      // hoje
      if (dataStr === hojeStr) {
        div.classList.add('hoje');
      }

      if (qtd === 0) {
        // ğŸ¨ sÃ¡bado / domingo sem evento
        if (diaSemana === 6) div.style.background = '#dbeafe';
        if (diaSemana === 0) div.style.background = '#fde2e2';

        div.innerText = dia;
      } 
      else {
        div.classList.add('culto');

        if (qtd === 1) {
          div.innerHTML = `
            ${dia}
            <small>${iconeTipo(eventos[0].tipo)}</small>
          `;
        }
        else if (qtd === 2) {
          div.innerHTML = `
            ${dia}
            <small>
              ${iconeTipo(eventos[0].tipo)}<br>
              ${iconeTipo(eventos[1].tipo)}
            </small>
          `;
        }
        else {
          div.innerHTML = `
            ${dia}
            <small>ğŸ”… ${qtd}</small>
          `;
        }

        div.style.cursor = 'pointer';
        div.onclick = () => abrirModal(dataStr);
      }

      grid.appendChild(div);
      
    }
     atualizarLegendaAtiva();
    }


    function atualizarLegendaAtiva() {

      const tiposDoMes = new Set();

      const ano = dataAtual.getFullYear();
      const mes = dataAtual.getMonth() + 1;

      Object.keys(cultos).forEach(data => {
        const [a, m] = data.split('-').map(Number);

        if (a === ano && m === mes) {
          const eventos = eventosDoDia(data);
          eventos.forEach(ev => {
            if (ev.tipo) tiposDoMes.add(ev.tipo);
          });
        }
      });

      document.querySelectorAll('.agenda-legenda span').forEach(span => {
        const tipo = span.dataset.tipo;
        span.classList.toggle('ativo', tiposDoMes.has(tipo));
      });

    }

    function mesAnterior() {
    dataAtual.setMonth(dataAtual.getMonth() - 1);
    renderAgenda();
    }

    function mesSeguinte() {
    dataAtual.setMonth(dataAtual.getMonth() + 1);
    renderAgenda();
    }

    function renderAgendaSemanal() {
      const box = document.getElementById("agendaSemanal");
      if (!box) return;

      box.innerHTML = "";

      const hoje = new Date();
      hoje.setHours(0,0,0,0);

      for (let i = 0; i < 7; i++) {
        const d = new Date(hoje);
        d.setDate(hoje.getDate() + i);

        const ano = d.getFullYear();
        const mes = String(d.getMonth() + 1).padStart(2,'0');
        const dia = String(d.getDate()).padStart(2,'0');
        const dataStr = `${ano}-${mes}-${dia}`;

        const nomeDia = d.toLocaleDateString("pt-BR", { weekday: "long" });
        const dataCurta = d.toLocaleDateString("pt-BR");

        const eventos = eventosDoDia(dataStr);

        const card = document.createElement("div");
        card.className = "semana-card";

        if (eventos.length > 0) {

          const listaEventos = eventos.map(ev => `
            <small>
              ${iconeTipo(ev.tipo)} ${ev.titulo} â€“ ${ev.hora}
            </small>
          `).join('');

          card.innerHTML = `
            ğŸ“… ${nomeDia}
            <small>${dataCurta}</small>
            ${listaEventos}
            <span class="tag">Culto</span>
          `;

        } else {

          card.innerHTML = `
            ğŸ“† ${nomeDia}
            <small>${dataCurta}</small>
            <small>Sem evento</small>
            <span class="tag">Agenda livre</span>
          `;

          card.style.opacity = "0.85";
        }

        box.appendChild(card);
      }
    }


    function fecharModal() {
    document.getElementById("modalEvento").style.display = "none";
    }

    function clicouForaModal(e) {
    // fecha se clicar fora da caixa branca
    if (e.target.id === "modalEvento") {
        fecharModal();
    }
    }

    function abrirModal(data) {

      const eventos = eventosDoDia(data);
      if (eventos.length === 0) return;

      const modal  = document.getElementById("modalEvento");
      const titulo = document.getElementById("modalTitulo");
      const dataEl = document.getElementById("modalData");
      const box    = document.getElementById("modalListaEventos");

      // ğŸ”¹ limpa estado anterior
      box.innerHTML = "";
      modal.classList.remove("modal-unico");

      // ğŸ”¹ data formatada
      dataEl.innerText = `ğŸ“… ${data.split('-').reverse().join('/')}`;

      // ==========================
      // ğŸ”¹ CASO 1: APENAS UM EVENTO
      // ==========================
      if (eventos.length === 1) {

        const ev = eventos[0];

        modal.classList.add("modal-unico");
        titulo.innerText = `${iconeTipo(ev.tipo)} ${ev.titulo}`;

        box.innerHTML = `
          <p>â° <strong>HorÃ¡rio:</strong> ${ev.hora}</p>
          <p>ğŸ¤ <strong>Dirigente:</strong> ${ev.dirigente || "A definir"}</p>

          ${ev.tema ? `<p class="modal-tema">ğŸ“– <strong>Tema:</strong> ${ev.tema}</p>` : ``}
          ${ev.observacao ? `<p class="modal-obs">ğŸ“ ${ev.observacao}</p>` : ``}
        `;

      }

      // ==========================
      // ğŸ”¹ CASO 2: MÃšLTIPLOS EVENTOS
      // ==========================
      else {

        titulo.innerText = "ğŸ“… Eventos do Dia";

        eventos.forEach(ev => {
          const div = document.createElement("div");
          div.className = "modal-evento-item";

          div.innerHTML = `
            <h4>${iconeTipo(ev.tipo)} ${ev.titulo}</h4>
            <p>â° ${ev.hora}</p>
            <p>ğŸ¤ ${ev.dirigente || "A definir"}</p>
            ${ev.tema ? `<p class="modal-tema">ğŸ“– ${ev.tema}</p>` : ``}
            ${ev.observacao ? `<p class="modal-obs">ğŸ“ ${ev.observacao}</p>` : ``}
          `;

          box.appendChild(div);
        });
      }

      modal.style.display = "flex";
    }


    let cultos = {};

    async function carregarCultos() {
    try {
        const resp = await fetch('cultos.json?v=' + Date.now());
        if (!resp.ok) throw new Error('Erro ao carregar agenda');

        cultos = await resp.json();

        renderAgenda();
        renderAgendaSemanal();

    } catch (e) {
        console.error('Erro ao carregar cultos:', e);
    }
    }

    document.addEventListener("DOMContentLoaded", () => {

      carregarVersiculos();
      carregarCultos();

      // legenda mobile
      const legenda = document.getElementById("agendaLegenda");
      const btnLegenda = document.querySelector(".btn-legenda-toggle");

      if (window.innerWidth <= 768) {
        legenda.classList.remove("show");
        btnLegenda.innerText = "â„¹ï¸ Mostrar legenda";
      }

    });


</script>

</body>
</html>